<!DOCTYPE html>
<html>
<head>
    <title>Manage Socio-Events</title>
    <style>
        body {
            font-family: Arial;
            background: #f4f6f9;
            padding: 40px;
        }

        table {
            width: 100%;
            background: white;
            border-collapse: collapse;
        }

        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
            vertical-align: middle;
        }

        th {
            background: #0d47a1;
            color: white;
        }

        a {
            text-decoration: none;
            font-weight: bold;
        }

        .add {
            margin-bottom: 15px;
            display: inline-block;
        }

        .flash {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
        }

        .success {
            background: #d4edda;
            color: #155724;
        }

        .danger {
            background: #f8d7da;
            color: #721c24;
        }

        .event-images {
            display: flex;
            gap: 6px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .event-images img {
            width: 70px;
            height: 55px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>

<h2>Events</h2>

<!-- FLASH MESSAGES -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="flash {{ category }}">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<a class="add" href="{{ url_for('admin.add_event') }}">
    â• Add Event
</a> |
<a href="{{ url_for('admin.dashboard') }}">
    Dashboard
</a>

<table>
<tr>
    <th>#</th>
    <th>Title</th>
    <th>Date</th>
    <th>Images</th>
    <th>ğŸ“Œ</th>
    <th>Action</th>
</tr>

{% for e in items %}
<tr>
    <td>{{ loop.index }}</td>
    <td>{{ e.title }}</td>

    <td>
    {% if e.event_date %}
        {% if e.event_date.__class__.__name__ == 'date' %}
            {{ e.event_date.strftime('%d-%m-%Y') }}
        {% else %}
            {{ e.event_date }}
        {% endif %}
    {% else %}
        -
    {% endif %}
</td>

    <td>
        {% if e.image %}
            {% set images = e.image.split(",") %}
            <div class="event-images">
                {% for img in images %}
                    <img src="{{ img.strip() }}">
                {% endfor %}
            </div>
        {% else %}
            -
        {% endif %}
    </td>

    <td>
        {% if e.pinned %}
            <a href="{{ url_for('admin.unpin_event', id=e.id) }}">ğŸ“Œ</a>
        {% else %}
            <a href="{{ url_for('admin.pin_event', id=e.id) }}">ğŸ“</a>
        {% endif %}
    </td>

    <td>
        <a href="{{ url_for('admin.edit_event', id=e.id) }}">âœï¸ Edit</a> |
        <a href="{{ url_for('admin.delete_event', id=e.id) }}"
           onclick="return confirm('Delete this event?')">
           âŒ Delete
        </a>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="6">No events found</td>
</tr>
{% endfor %}

</table>

</body>
</html>